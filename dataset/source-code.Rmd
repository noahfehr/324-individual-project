---
title: "source-code"
output: html_document
---
We've got our data in. Now, we want to manipulate these to end up with two tables. One table with country and total energy consumption; the other with country and renewable energy production
```{r}
library(tidyverse)
library(ggplot2)
renewablebycountry <- read.csv("countrygeneration.csv")
consumptionbycountry <-read.csv("countryconsumption.csv")

# This next block of code is focusing on areas of interest (country and total renewable energy produced)
renewablebycountry <- rename(renewablebycountry, "total" = "Total..TWh.")
renewablebycountry <- select(renewablebycountry, c("Country", "total"))

# the renewablecountry data is from 2017, so we'll just focus on consumption from 2017
consumptionbycountry <- filter(consumptionbycountry, Year == 2017)
# now we want to configure a table based on this data to match the specifications described above
Country <- colnames(consumptionbycountry) [-1]
Consumption <- as.numeric(consumptionbycountry) [-1]
consumptionbycountry <- data.frame(Country, Consumption)

# now we want to merge these together into one table by country
CountryRel <- merge (consumptionbycountry, renewablebycountry, by="Country")
allCountries <- ggplot(CountryRel, aes(x=Consumption, y=total)) +
                    geom_point()

nooutliers <- filter(CountryRel, Country != "China" & Country != "Brazil")

#Remove China (outlier)
nooutliers
noChina <- ggplot(nooutliers, aes(x=Consumption, y=total)) +
  geom_point() +
  xlab("Total Energy Consumption") + 
  ylab("Total Renewable Energy Production") 
  #geom_text(label=nooutliers$Country, nudge_x = 50) #goal is to have these appear when you hover

noChina
```
```{r}
library(shiny)
data <- read.csv("yearbyyear.csv")
data
lbls <- colnames(data) [-1]
yeardata <- filter(data, Year == 2016)
values <- as.numeric(yeardata)
pie(values, labels = lbls, main="Pie Chart")
```
```{r}

ui <- fluidPage(
  sliderInput(inputId = "year", 
              label = "Slide to adjust the year", 
              value = 2015, min = 1997, max = 2017),
  plotOutput("pie"),
  plotOutput("scatter", click = "plot_click"),
  verbatimTextOutput("info")
)

server <- function(input, output) {
  
  output$pie <- renderPlot({
    #pie chart
    yeardata <- filter(data, Year == input$year)
    values <- as.numeric(yeardata)
    pie(values, labels = lbls, main="Pie Chart")
    })
  
  output$scatter <- renderPlot({
    ggplot(nooutliers, aes(x=Consumption, y=total)) +
    geom_point() 
    })
  
  ##Playing around with click to display
  output$info <- renderText({
    point <- nearPoints(nooutliers, input$plot_click, threshold = 10, maxpoints = 1)
    if(nrow(point) == 0) return(NULL)
    paste0("Country name: ", point$Country)
  })
}

shinyApp(ui = ui, server = server)
```


## R Markdown
own is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
